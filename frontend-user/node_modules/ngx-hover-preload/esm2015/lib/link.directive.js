import { Directive, Optional, } from '@angular/core';
import { RouterLink, RouterLinkWithHref, RouterPreloader } from '@angular/router';
import { RegistryService } from './registry.service';
export class LinkDirective {
    constructor(_loader, _registry, link, linkWithHref) {
        this._loader = _loader;
        this._registry = _registry;
        this._rl = link || linkWithHref;
    }
    prefetch() {
        requestIdleCallback(() => {
            this._registry.add(this._rl.urlTree);
            this._loader.preload().subscribe(() => void 0);
        });
    }
}
LinkDirective.decorators = [
    { type: Directive, args: [{
                selector: '[routerLink]',
                host: {
                    '(mouseenter)': 'prefetch()'
                }
            },] }
];
LinkDirective.ctorParameters = () => [
    { type: RouterPreloader },
    { type: RegistryService },
    { type: RouterLink, decorators: [{ type: Optional }] },
    { type: RouterLinkWithHref, decorators: [{ type: Optional }] }
];
const ɵ0 = function (cb) {
    const start = Date.now();
    return setTimeout(function () {
        cb({
            didTimeout: false,
            timeRemaining: function () {
                return Math.max(0, 50 - (Date.now() - start));
            }
        });
    }, 1);
}, ɵ1 = () => { };
const requestIdleCallback = typeof window !== 'undefined'
    ? window.requestIdleCallback || ɵ0
    : ɵ1;
export { ɵ0, ɵ1 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGluay5kaXJlY3RpdmUuanMiLCJzb3VyY2VSb290IjoiLi4vLi4vLi4vcHJvamVjdHMvbmd4LWhvdmVyLXByZWxvYWQvc3JjLyIsInNvdXJjZXMiOlsibGliL2xpbmsuZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxTQUFTLEVBQUUsUUFBUSxHQUNwQixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsVUFBVSxFQUFFLGtCQUFrQixFQUFFLGVBQWUsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ2xGLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQVVyRCxNQUFNLE9BQU8sYUFBYTtJQUV4QixZQUNVLE9BQXdCLEVBQ3hCLFNBQTBCLEVBQ3RCLElBQWdCLEVBQ2hCLFlBQWdDO1FBSHBDLFlBQU8sR0FBUCxPQUFPLENBQWlCO1FBQ3hCLGNBQVMsR0FBVCxTQUFTLENBQWlCO1FBSWxDLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxJQUFJLFlBQVksQ0FBQztJQUNsQyxDQUFDO0lBRUQsUUFBUTtRQUNOLG1CQUFtQixDQUFDLEdBQUcsRUFBRTtZQUN2QixJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3JDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUMsU0FBUyxDQUFDLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7UUFDakQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDOzs7WUF0QkYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSxjQUFjO2dCQUN4QixJQUFJLEVBQUU7b0JBQ0osY0FBYyxFQUFFLFlBQVk7aUJBQzdCO2FBQ0Y7OztZQVZ3QyxlQUFlO1lBQy9DLGVBQWU7WUFEZixVQUFVLHVCQWdCZCxRQUFRO1lBaEJRLGtCQUFrQix1QkFpQmxDLFFBQVE7O1dBOEJQLFVBQVMsRUFBWTtJQUNuQixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDekIsT0FBTyxVQUFVLENBQUM7UUFDaEIsRUFBRSxDQUFDO1lBQ0QsVUFBVSxFQUFFLEtBQUs7WUFDakIsYUFBYSxFQUFFO2dCQUNiLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUM7WUFDaEQsQ0FBQztTQUNGLENBQUMsQ0FBQztJQUNMLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztBQUNSLENBQUMsT0FDRCxHQUFHLEVBQUUsR0FBRSxDQUFDO0FBZGQsTUFBTSxtQkFBbUIsR0FDdkIsT0FBTyxNQUFNLEtBQUssV0FBVztJQUMzQixDQUFDLENBQUUsTUFBYyxDQUFDLG1CQUFtQixNQVdsQztJQUNILENBQUMsR0FBUyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgRGlyZWN0aXZlLCBPcHRpb25hbCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBSb3V0ZXJMaW5rLCBSb3V0ZXJMaW5rV2l0aEhyZWYsIFJvdXRlclByZWxvYWRlciB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQgeyBSZWdpc3RyeVNlcnZpY2UgfSBmcm9tICcuL3JlZ2lzdHJ5LnNlcnZpY2UnO1xuXG5cblxuQERpcmVjdGl2ZSh7XG4gIHNlbGVjdG9yOiAnW3JvdXRlckxpbmtdJyxcbiAgaG9zdDoge1xuICAgICcobW91c2VlbnRlciknOiAncHJlZmV0Y2goKSdcbiAgfVxufSlcbmV4cG9ydCBjbGFzcyBMaW5rRGlyZWN0aXZlIHtcbiAgcHJpdmF0ZSBfcmw6IFJvdXRlckxpbmsgfCBSb3V0ZXJMaW5rV2l0aEhyZWY7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgX2xvYWRlcjogUm91dGVyUHJlbG9hZGVyLFxuICAgIHByaXZhdGUgX3JlZ2lzdHJ5OiBSZWdpc3RyeVNlcnZpY2UsXG4gICAgQE9wdGlvbmFsKCkgbGluazogUm91dGVyTGluayxcbiAgICBAT3B0aW9uYWwoKSBsaW5rV2l0aEhyZWY6IFJvdXRlckxpbmtXaXRoSHJlZlxuICApIHtcbiAgICB0aGlzLl9ybCA9IGxpbmsgfHwgbGlua1dpdGhIcmVmO1xuICB9XG5cbiAgcHJlZmV0Y2goKSB7XG4gICAgcmVxdWVzdElkbGVDYWxsYmFjaygoKSA9PiB7XG4gICAgICB0aGlzLl9yZWdpc3RyeS5hZGQodGhpcy5fcmwudXJsVHJlZSk7XG4gICAgICB0aGlzLl9sb2FkZXIucHJlbG9hZCgpLnN1YnNjcmliZSgoKSA9PiB2b2lkIDApO1xuICAgIH0pO1xuICB9XG59XG5cbnR5cGUgUmVxdWVzdElkbGVDYWxsYmFja0hhbmRsZSA9IGFueTtcbnR5cGUgUmVxdWVzdElkbGVDYWxsYmFja09wdGlvbnMgPSB7XG4gIHRpbWVvdXQ6IG51bWJlcjtcbn07XG50eXBlIFJlcXVlc3RJZGxlQ2FsbGJhY2tEZWFkbGluZSA9IHtcbiAgcmVhZG9ubHkgZGlkVGltZW91dDogYm9vbGVhbjtcbiAgdGltZVJlbWFpbmluZzogKCgpID0+IG51bWJlcik7XG59O1xuXG50eXBlIFJlcXVlc3RJZGxlQ2FsbGJhY2sgPSAoKFxuICBjYWxsYmFjazogKChkZWFkbGluZTogUmVxdWVzdElkbGVDYWxsYmFja0RlYWRsaW5lKSA9PiB2b2lkKSxcbiAgb3B0cz86IFJlcXVlc3RJZGxlQ2FsbGJhY2tPcHRpb25zXG4pID0+IFJlcXVlc3RJZGxlQ2FsbGJhY2tIYW5kbGUpO1xuXG5jb25zdCByZXF1ZXN0SWRsZUNhbGxiYWNrOiBSZXF1ZXN0SWRsZUNhbGxiYWNrID1cbiAgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgICA/ICh3aW5kb3cgYXMgYW55KS5yZXF1ZXN0SWRsZUNhbGxiYWNrIHx8XG4gICAgICBmdW5jdGlvbihjYjogRnVuY3Rpb24pIHtcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBjYih7XG4gICAgICAgICAgICBkaWRUaW1lb3V0OiBmYWxzZSxcbiAgICAgICAgICAgIHRpbWVSZW1haW5pbmc6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICByZXR1cm4gTWF0aC5tYXgoMCwgNTAgLSAoRGF0ZS5ub3coKSAtIHN0YXJ0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0sIDEpO1xuICAgICAgfVxuICAgIDogKCkgPT4ge307XG4iXX0=