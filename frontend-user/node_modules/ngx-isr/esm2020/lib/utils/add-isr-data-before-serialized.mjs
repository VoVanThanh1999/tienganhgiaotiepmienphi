export function addIsrDataBeforeSerialized(isrService, doc) {
    return () => addISRDataToBody(doc, isrService.getState());
}
// append script with revalidate and errors data for the current route
function addISRDataToBody(doc, { revalidate, errors, extra }) {
    return new Promise(resolve => {
        const script = doc.createElement('script');
        script.id = 'isr-state';
        script.setAttribute('type', 'application/json');
        let toBeSerialized = { revalidate };
        if (errors.length)
            toBeSerialized = { ...toBeSerialized, errors };
        if (Object.keys(extra).length)
            toBeSerialized = { ...toBeSerialized, extra };
        script.textContent = JSON.stringify(toBeSerialized);
        doc.body.appendChild(script);
        resolve();
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWRkLWlzci1kYXRhLWJlZm9yZS1zZXJpYWxpemVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LWlzci9zcmMvbGliL3V0aWxzL2FkZC1pc3ItZGF0YS1iZWZvcmUtc2VyaWFsaXplZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFFQSxNQUFNLFVBQVUsMEJBQTBCLENBQUMsVUFBeUIsRUFBRSxHQUFhO0lBQ2pGLE9BQU8sR0FBRyxFQUFFLENBQUMsZ0JBQWdCLENBQUMsR0FBRyxFQUFFLFVBQVUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDO0FBQzVELENBQUM7QUFFRCxzRUFBc0U7QUFDdEUsU0FBUyxnQkFBZ0IsQ0FBQyxHQUFhLEVBQUUsRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBZTtJQUNqRixPQUFPLElBQUksT0FBTyxDQUFPLE9BQU8sQ0FBQyxFQUFFO1FBQ2pDLE1BQU0sTUFBTSxHQUFHLEdBQUcsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDM0MsTUFBTSxDQUFDLEVBQUUsR0FBRyxXQUFXLENBQUM7UUFDeEIsTUFBTSxDQUFDLFlBQVksQ0FBQyxNQUFNLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztRQUVoRCxJQUFJLGNBQWMsR0FBUSxFQUFFLFVBQVUsRUFBRSxDQUFDO1FBRXpDLElBQUksTUFBTSxDQUFDLE1BQU07WUFBRSxjQUFjLEdBQUcsRUFBRSxHQUFHLGNBQWMsRUFBRSxNQUFNLEVBQUUsQ0FBQztRQUNsRSxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTTtZQUFFLGNBQWMsR0FBRyxFQUFFLEdBQUcsY0FBYyxFQUFFLEtBQUssRUFBRSxDQUFDO1FBRTdFLE1BQU0sQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUNwRCxHQUFHLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUM3QixPQUFPLEVBQUUsQ0FBQztJQUNaLENBQUMsQ0FBQyxDQUFBO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5neElzclNlcnZpY2UsIE5neElzclN0YXRlIH0gZnJvbSAnLi4vbmd4LWlzci5zZXJ2aWNlJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFkZElzckRhdGFCZWZvcmVTZXJpYWxpemVkKGlzclNlcnZpY2U6IE5neElzclNlcnZpY2UsIGRvYzogRG9jdW1lbnQpOiAoKSA9PiBQcm9taXNlPHZvaWQ+IHtcbiAgcmV0dXJuICgpID0+IGFkZElTUkRhdGFUb0JvZHkoZG9jLCBpc3JTZXJ2aWNlLmdldFN0YXRlKCkpO1xufVxuXG4vLyBhcHBlbmQgc2NyaXB0IHdpdGggcmV2YWxpZGF0ZSBhbmQgZXJyb3JzIGRhdGEgZm9yIHRoZSBjdXJyZW50IHJvdXRlXG5mdW5jdGlvbiBhZGRJU1JEYXRhVG9Cb2R5KGRvYzogRG9jdW1lbnQsIHsgcmV2YWxpZGF0ZSwgZXJyb3JzLCBleHRyYSB9OiBOZ3hJc3JTdGF0ZSk6IFByb21pc2U8dm9pZD4ge1xuICByZXR1cm4gbmV3IFByb21pc2U8dm9pZD4ocmVzb2x2ZSA9PiB7XG4gICAgY29uc3Qgc2NyaXB0ID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgIHNjcmlwdC5pZCA9ICdpc3Itc3RhdGUnO1xuICAgIHNjcmlwdC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYXBwbGljYXRpb24vanNvbicpO1xuXG4gICAgbGV0IHRvQmVTZXJpYWxpemVkOiBhbnkgPSB7IHJldmFsaWRhdGUgfTtcblxuICAgIGlmIChlcnJvcnMubGVuZ3RoKSB0b0JlU2VyaWFsaXplZCA9IHsgLi4udG9CZVNlcmlhbGl6ZWQsIGVycm9ycyB9O1xuICAgIGlmIChPYmplY3Qua2V5cyhleHRyYSkubGVuZ3RoKSB0b0JlU2VyaWFsaXplZCA9IHsgLi4udG9CZVNlcmlhbGl6ZWQsIGV4dHJhIH07XG5cbiAgICBzY3JpcHQudGV4dENvbnRlbnQgPSBKU09OLnN0cmluZ2lmeSh0b0JlU2VyaWFsaXplZCk7XG4gICAgZG9jLmJvZHkuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbiAgICByZXNvbHZlKCk7XG4gIH0pXG59XG4iXX0=